package com.HEJZ.HEJZ_back.domain.music.service;

import com.HEJZ.HEJZ_back.domain.music.dto.SongSaveLyricsDTO;
import com.HEJZ.HEJZ_back.domain.music.entity.Song;
import com.HEJZ.HEJZ_back.domain.music.repository.SongRepository;
import com.HEJZ.HEJZ_back.global.exception.ErrorResponse;
import com.HEJZ.HEJZ_back.global.response.ApiResponse;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;
import lombok.RequiredArgsConstructor;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.stereotype.Service;

import java.io.IOException;
import java.rmi.server.ExportException;
import java.util.List;
import java.util.Map;

@Service
@RequiredArgsConstructor
public class SongService {
    // suno api를 쓰지 않는 u-star 자체 api service

    private final SongRepository songRepository;
    public ResponseEntity<ApiResponse<Object>> getLyrics(String taskid){
        // 노래 id를 통해 DB에서 해당 곡 가사 가져오는 기능
        // method: get
        // request : song_taskid

        
        try{
//            Song song = songRepository.findByTaskId(taskid)
//                    .orElseThrow(() -> new RuntimeException("해당 taskId의 노래가 없음"));


//            return song.getLyrics();

            String lyrics = "{\"alignedWords\":[{\"word\":\"[Verse]\\n담배 \",\"success\":true,\"startS\":7.10106,\"endS\":7.34043,\"palign\":0},{\"word\":\"연기 \",\"success\":true,\"startS\":7.5,\"endS\":7.97872,\"palign\":0},{\"word\":\"속에 \",\"success\":true,\"startS\":8.1383,\"endS\":8.37766,\"palign\":0},{\"word\":\"내 \",\"success\":true,\"startS\":8.53723,\"endS\":8.61702,\"palign\":0},{\"word\":\"맘을 \",\"success\":true,\"startS\":8.7766,\"endS\":9.09574,\"palign\":0},{\"word\":\"던져\\n\",\"success\":true,\"startS\":9.25532,\"endS\":10.45213,\"palign\":0},{\"word\":\"좋지만 \",\"success\":true,\"startS\":10.6117,\"endS\":11.32979,\"palign\":0},{\"word\":\"싫어 \",\"success\":true,\"startS\":11.48936,\"endS\":11.8883,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":12.04787,\"endS\":12.12766,\"palign\":0},{\"word\":\"모순의 \",\"success\":true,\"startS\":12.28723,\"endS\":12.76596,\"palign\":0},{\"word\":\"번져\\n\",\"success\":true,\"startS\":12.92553,\"endS\":14.68085,\"palign\":0},{\"word\":\"한 \",\"success\":true,\"startS\":14.84043,\"endS\":15.07979,\"palign\":0},{\"word\":\"모금 \",\"success\":true,\"startS\":15.23936,\"endS\":15.55851,\"palign\":0},{\"word\":\"한숨 \",\"success\":true,\"startS\":15.71809,\"endS\":16.19681,\"palign\":0},{\"word\":\"끊어야 \",\"success\":true,\"startS\":16.35638,\"endS\":17.39362,\"palign\":0},{\"word\":\"해\\n\",\"success\":true,\"startS\":17.55319,\"endS\":17.87234,\"palign\":0},{\"word\":\"하지만 \",\"success\":true,\"startS\":18.03191,\"endS\":18.75,\"palign\":0},{\"word\":\"손이 \",\"success\":true,\"startS\":18.90957,\"endS\":19.22872,\"palign\":0},{\"word\":\"또 \",\"success\":true,\"startS\":19.3883,\"endS\":19.70745,\"palign\":0},{\"word\":\"담배를 \",\"success\":true,\"startS\":19.86702,\"endS\":20.18617,\"palign\":0},{\"word\":\"매\\n\\n\",\"success\":true,\"startS\":20.34574,\"endS\":20.353,\"palign\":0},{\"word\":\"[Chorus]\\n끊고 \",\"success\":true,\"startS\":20.36025,\"endS\":21.2234,\"palign\":0},{\"word\":\"싶어 \",\"success\":true,\"startS\":21.2633,\"endS\":21.30319,\"palign\":0},{\"word\":\"끊기 \",\"success\":true,\"startS\":21.46277,\"endS\":21.78191,\"palign\":0},{\"word\":\"싫어\\n\",\"success\":true,\"startS\":21.94149,\"endS\":23.05851,\"palign\":0},{\"word\":\"끊고 \",\"success\":true,\"startS\":23.1383,\"endS\":23.37766,\"palign\":0},{\"word\":\"싶어 \",\"success\":true,\"startS\":23.45745,\"endS\":23.53723,\"palign\":0},{\"word\":\"끊기 \",\"success\":true,\"startS\":23.57713,\"endS\":23.61702,\"palign\":0},{\"word\":\"싫어\\n\",\"success\":true,\"startS\":23.7766,\"endS\":24.9734,\"palign\":0},{\"word\":\"내 \",\"success\":true,\"startS\":25.13298,\"endS\":25.21277,\"palign\":0},{\"word\":\"맘속엔 \",\"success\":true,\"startS\":25.37234,\"endS\":26.32979,\"palign\":0},{\"word\":\"두 \",\"success\":true,\"startS\":26.48936,\"endS\":26.56915,\"palign\":0},{\"word\":\"목소리 \",\"success\":true,\"startS\":26.72872,\"endS\":28.56383,\"palign\":0},{\"word\":\"더\\n\",\"success\":true,\"startS\":28.64362,\"endS\":28.64362,\"palign\":0},{\"word\":\"몸은 \",\"success\":true,\"startS\":28.80319,\"endS\":29.12234,\"palign\":0},{\"word\":\"외치고 \",\"success\":true,\"startS\":29.28191,\"endS\":30.31915,\"palign\":0},{\"word\":\"마음은 \",\"success\":true,\"startS\":30.47872,\"endS\":30.95745,\"palign\":0},{\"word\":\"비명\\n\",\"success\":true,\"startS\":31.11702,\"endS\":32.15426,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":32.31383,\"endS\":32.31383,\"palign\":0},{\"word\":\"혼란 \",\"success\":true,\"startS\":32.4734,\"endS\":32.79255,\"palign\":0},{\"word\":\"속에 \",\"success\":true,\"startS\":32.95213,\"endS\":33.27128,\"palign\":0},{\"word\":\"갇힌 \",\"success\":true,\"startS\":33.43085,\"endS\":34.22872,\"palign\":0},{\"word\":\"나의 \",\"success\":true,\"startS\":34.3883,\"endS\":34.62766,\"palign\":0},{\"word\":\"심경\\n\\n\",\"success\":true,\"startS\":34.78723,\"endS\":35.21011,\"palign\":0},{\"word\":\"[Outro]\\n오늘도 \",\"success\":true,\"startS\":35.23404,\"endS\":35.82447,\"palign\":0},{\"word\":\"난 \",\"success\":true,\"startS\":35.98404,\"endS\":36.30319,\"palign\":0},{\"word\":\"다짐의 \",\"success\":true,\"startS\":36.38298,\"endS\":36.70213,\"palign\":0},{\"word\":\"불씨를 \",\"success\":true,\"startS\":36.8617,\"endS\":37.26064,\"palign\":0},{\"word\":\"켜\\n\",\"success\":true,\"startS\":37.42021,\"endS\":37.5,\"palign\":0},{\"word\":\"첫 \",\"success\":true,\"startS\":37.65957,\"endS\":37.65957,\"palign\":0},{\"word\":\"불 \",\"success\":true,\"startS\":37.73936,\"endS\":37.73936,\"palign\":0},{\"word\":\"붙일 \",\"success\":true,\"startS\":37.89894,\"endS\":38.21809,\"palign\":0},{\"word\":\"땐 \",\"success\":true,\"startS\":38.29787,\"endS\":38.37766,\"palign\":0},{\"word\":\"세상이 \",\"success\":true,\"startS\":38.45745,\"endS\":38.69681,\"palign\":0},{\"word\":\"멈춰\\n\",\"success\":true,\"startS\":38.85638,\"endS\":40.05319,\"palign\":0},{\"word\":\"하지만 \",\"success\":true,\"startS\":40.21277,\"endS\":40.93085,\"palign\":0},{\"word\":\"끝엔 \",\"success\":true,\"startS\":41.09043,\"endS\":41.64894,\"palign\":0},{\"word\":\"죄책감 \",\"success\":true,\"startS\":41.80851,\"endS\":42.28723,\"palign\":0},{\"word\":\"넘쳐\\n\",\"success\":true,\"startS\":42.36702,\"endS\":42.76596,\"palign\":0},{\"word\":\"입안에 \",\"success\":true,\"startS\":42.92553,\"endS\":44.60106,\"palign\":0},{\"word\":\"남은 \",\"success\":true,\"startS\":44.76064,\"endS\":45.07979,\"palign\":0},{\"word\":\"쓴맛의 \",\"success\":true,\"startS\":45.15957,\"endS\":45.55851,\"palign\":0},{\"word\":\"흔적\\n\",\"success\":true,\"startS\":45.71809,\"endS\":45.79787,\"palign\":0},{\"word\":\"입안에 \",\"success\":true,\"startS\":45.95745,\"endS\":46.67553,\"palign\":0},{\"word\":\"남은 \",\"success\":true,\"startS\":46.75532,\"endS\":46.83511,\"palign\":0},{\"word\":\"쓴맛의 \",\"success\":true,\"startS\":46.8617,\"endS\":46.91489,\"palign\":0},{\"word\":\"흔적\\n\",\"success\":true,\"startS\":47.07447,\"endS\":47.39362,\"palign\":0},{\"word\":\"행복과 \",\"success\":true,\"startS\":47.55319,\"endS\":48.27128,\"palign\":0},{\"word\":\"슬픔의 \",\"success\":true,\"startS\":48.43085,\"endS\":48.90957,\"palign\":0},{\"word\":\"끈적한 \",\"success\":true,\"startS\":48.94947,\"endS\":49.22872,\"palign\":0},{\"word\":\"연결\\n\\n\",\"success\":true,\"startS\":49.24368,\"endS\":49.28856,\"palign\":0},{\"word\":\"[Bridge]\\n날 \",\"success\":true,\"startS\":49.30352,\"endS\":49.45312,\"palign\":0},{\"word\":\"잡아줘 \",\"success\":true,\"startS\":49.46809,\"endS\":49.78723,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":49.94681,\"endS\":50.18617,\"palign\":0},{\"word\":\"굴레 \",\"success\":true,\"startS\":50.34574,\"endS\":51.10372,\"palign\":0},{\"word\":\"속에서\\n\",\"success\":true,\"startS\":51.14362,\"endS\":51.2234,\"palign\":0},{\"word\":\"날 \",\"success\":true,\"startS\":51.30319,\"endS\":51.30319,\"palign\":0},{\"word\":\"잡아줘 \",\"success\":true,\"startS\":51.46277,\"endS\":52.18085,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":52.34043,\"endS\":52.5,\"palign\":0},{\"word\":\"굴레 \",\"success\":true,\"startS\":52.65957,\"endS\":52.89894,\"palign\":0},{\"word\":\"속에서\\n\",\"success\":true,\"startS\":53.05851,\"endS\":54.73404,\"palign\":0},{\"word\":\"내 \",\"success\":true,\"startS\":54.89362,\"endS\":54.9734,\"palign\":0},{\"word\":\"의지와 \",\"success\":true,\"startS\":55.13298,\"endS\":55.85106,\"palign\":0},{\"word\":\"욕망의 \",\"success\":true,\"startS\":56.01064,\"endS\":56.56915,\"palign\":0},{\"word\":\"대결선에서\\n\",\"success\":true,\"startS\":56.72872,\"endS\":58.96277,\"palign\":0},{\"word\":\"이제는 \",\"success\":true,\"startS\":59.12234,\"endS\":59.84043,\"palign\":0},{\"word\":\"끝내야 \",\"success\":true,\"startS\":60.0,\"endS\":60.79787,\"palign\":0},{\"word\":\"할 \",\"success\":true,\"startS\":60.95745,\"endS\":61.19681,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":61.35638,\"endS\":61.43617,\"palign\":0},{\"word\":\"게임\\n\",\"success\":true,\"startS\":61.59574,\"endS\":62.15426,\"palign\":0},{\"word\":\"하지만 \",\"success\":true,\"startS\":62.31383,\"endS\":63.03191,\"palign\":0},{\"word\":\"손은 \",\"success\":true,\"startS\":63.19149,\"endS\":63.51064,\"palign\":0},{\"word\":\"다시금 \",\"success\":true,\"startS\":63.67021,\"endS\":64.3883,\"palign\":0},{\"word\":\"Flame\\n\\n\",\"success\":true,\"startS\":64.48803,\"endS\":65.60687,\"palign\":0},{\"word\":\"[Chorus]\\n끊고 \",\"success\":true,\"startS\":65.62863,\"endS\":66.06383,\"palign\":0},{\"word\":\"싶어 \",\"success\":true,\"startS\":66.2234,\"endS\":66.38298,\"palign\":0},{\"word\":\"끊기 \",\"success\":true,\"startS\":66.42287,\"endS\":66.46277,\"palign\":0},{\"word\":\"싫어\\n\",\"success\":true,\"startS\":66.62234,\"endS\":67.5,\"palign\":0},{\"word\":\"끊고 \",\"success\":true,\"startS\":67.65957,\"endS\":67.89894,\"palign\":0},{\"word\":\"싶어 \",\"success\":true,\"startS\":67.93883,\"endS\":67.97872,\"palign\":0},{\"word\":\"끊기 \",\"success\":true,\"startS\":68.07846,\"endS\":68.27793,\"palign\":0},{\"word\":\"싫어\\n\",\"success\":true,\"startS\":68.37766,\"endS\":69.33511,\"palign\":0},{\"word\":\"내 \",\"success\":true,\"startS\":69.49468,\"endS\":69.57447,\"palign\":0},{\"word\":\"맘속엔 \",\"success\":true,\"startS\":69.73404,\"endS\":70.69149,\"palign\":0},{\"word\":\"두 \",\"success\":true,\"startS\":70.85106,\"endS\":70.93085,\"palign\":0},{\"word\":\"목소리 \",\"success\":true,\"startS\":71.09043,\"endS\":72.92553,\"palign\":0},{\"word\":\"더\\n\",\"success\":true,\"startS\":73.00532,\"endS\":73.00532,\"palign\":0},{\"word\":\"몸은 \",\"success\":true,\"startS\":73.16489,\"endS\":73.48404,\"palign\":0},{\"word\":\"외치고 \",\"success\":true,\"startS\":73.64362,\"endS\":74.68085,\"palign\":0},{\"word\":\"마음은 \",\"success\":true,\"startS\":74.80053,\"endS\":75.31915,\"palign\":0},{\"word\":\"비명\\n\",\"success\":true,\"startS\":75.47872,\"endS\":76.43617,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":76.59574,\"endS\":76.67553,\"palign\":0},{\"word\":\"혼란 \",\"success\":true,\"startS\":76.83511,\"endS\":77.15426,\"palign\":0},{\"word\":\"속에 \",\"success\":true,\"startS\":77.31383,\"endS\":77.63298,\"palign\":0},{\"word\":\"갇힌 \",\"success\":true,\"startS\":77.79255,\"endS\":78.51064,\"palign\":0},{\"word\":\"나의 \",\"success\":true,\"startS\":78.67021,\"endS\":78.98936,\"palign\":0},{\"word\":\"심경\\n\\n\",\"success\":true,\"startS\":79.14894,\"endS\":80.53723,\"palign\":0},{\"word\":\"[Outro]\\n오늘도 \",\"success\":true,\"startS\":80.56915,\"endS\":81.54255,\"palign\":0},{\"word\":\"난 \",\"success\":true,\"startS\":81.70213,\"endS\":81.78191,\"palign\":0},{\"word\":\"다짐의 \",\"success\":true,\"startS\":81.94149,\"endS\":82.42021,\"palign\":0},{\"word\":\"불씨를 \",\"success\":true,\"startS\":82.57979,\"endS\":83.37766,\"palign\":0},{\"word\":\"켜\\n\",\"success\":true,\"startS\":83.53723,\"endS\":84.25532,\"palign\":0},{\"word\":\"하지만 \",\"success\":true,\"startS\":84.41489,\"endS\":85.37234,\"palign\":0},{\"word\":\"내 \",\"success\":true,\"startS\":85.45213,\"endS\":85.45213,\"palign\":0},{\"word\":\"손엔 \",\"success\":true,\"startS\":85.6117,\"endS\":85.93085,\"palign\":0},{\"word\":\"담배가 \",\"success\":true,\"startS\":86.09043,\"endS\":86.64894,\"palign\":0},{\"word\":\"또 \",\"success\":true,\"startS\":86.80851,\"endS\":87.5266,\"palign\":0},{\"word\":\"있어\\n\",\"success\":true,\"startS\":87.64628,\"endS\":88.00532,\"palign\":0},{\"word\":\"내일은 \",\"success\":true,\"startS\":88.16489,\"endS\":88.88298,\"palign\":0},{\"word\":\"다를까 \",\"success\":true,\"startS\":89.04255,\"endS\":89.76064,\"palign\":0},{\"word\":\"속삭이며\\n\",\"success\":true,\"startS\":89.92021,\"endS\":91.67553,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":91.83511,\"endS\":91.91489,\"palign\":0},{\"word\":\"노래 \",\"success\":true,\"startS\":92.07447,\"endS\":92.55319,\"palign\":0},{\"word\":\"끝엔 \",\"success\":true,\"startS\":92.71277,\"endS\":93.27128,\"palign\":0},{\"word\":\"자유를 \",\"success\":true,\"startS\":93.43085,\"endS\":93.98936,\"palign\":0},{\"word\":\"꿈꾸며\\n\\n\",\"success\":true,\"startS\":94.14894,\"endS\":117.57012,\"palign\":0},{\"word\":\"[Outro]\\n오늘도 \",\"success\":true,\"startS\":117.61364,\"endS\":118.40426,\"palign\":0},{\"word\":\"난 \",\"success\":true,\"startS\":118.56383,\"endS\":118.64362,\"palign\":0},{\"word\":\"다짐의 \",\"success\":true,\"startS\":118.80319,\"endS\":119.3617,\"palign\":0},{\"word\":\"불씨를 \",\"success\":true,\"startS\":119.52128,\"endS\":120.23936,\"palign\":0},{\"word\":\"켜\\n\",\"success\":true,\"startS\":120.39894,\"endS\":121.19681,\"palign\":0},{\"word\":\"하지만 \",\"success\":true,\"startS\":121.35638,\"endS\":122.23404,\"palign\":0},{\"word\":\"내 \",\"success\":true,\"startS\":122.31383,\"endS\":122.31383,\"palign\":0},{\"word\":\"손엔 \",\"success\":true,\"startS\":122.4734,\"endS\":122.79255,\"palign\":0},{\"word\":\"담배가 \",\"success\":true,\"startS\":122.95213,\"endS\":123.51064,\"palign\":0},{\"word\":\"또 \",\"success\":true,\"startS\":123.67021,\"endS\":124.3883,\"palign\":0},{\"word\":\"있어\\n\",\"success\":true,\"startS\":124.50798,\"endS\":124.86702,\"palign\":0},{\"word\":\"내일은 \",\"success\":true,\"startS\":125.0266,\"endS\":125.82447,\"palign\":0},{\"word\":\"다를까 \",\"success\":true,\"startS\":125.98404,\"endS\":126.62234,\"palign\":0},{\"word\":\"속삭이며\\n\",\"success\":true,\"startS\":126.78191,\"endS\":128.61702,\"palign\":0},{\"word\":\"이 \",\"success\":true,\"startS\":128.7766,\"endS\":128.85638,\"palign\":0},{\"word\":\"노래 \",\"success\":true,\"startS\":129.01596,\"endS\":129.57447,\"palign\":0},{\"word\":\"끝엔 \",\"success\":true,\"startS\":129.73404,\"endS\":130.29255,\"palign\":0},{\"word\":\"자유를 \",\"success\":true,\"startS\":130.45213,\"endS\":130.93085,\"palign\":0},{\"word\":\"꿈꾸며\\n\\n\",\"success\":true,\"startS\":131.09043,\"endS\":131.64894,\"palign\":0}],\"waveformData\":[0.01389,0.02238,0.04663,0.03076,0.04005,0.02969,0.03518,0.023,0.03024,0.00406,0.01755,0.05463,0.0393,0.04137,0.03237,0.03976,0.02846,0.03194,0.01003,0.02502,0.05146,0.03676,0.03487,0.03337,0.04044,0.02729,0.04037,0.02303,0.03538,0.05373,0.05173,0.03834,0.03584,0.03238,0.08629,0.11024,0.10161,0.13376,0.08583,0.0628,0.13315,0.09322,0.12231,0.08951,0.13825,0.0719,0.09815,0.11439,0.0879,0.09827,0.03929,0.09944,0.06234,0.09613,0.1313,0.08823,0.11931,0.09154,0.12478,0.06439,0.12795,0.06534,0.08378,0.14248,0.09285,0.12838,0.08971,0.12103,0.0384,0.04213,0.09361,0.01634,0.09144,0.07989,0.11746,0.1174,0.10887,0.10867,0.09784,0.12051,0.07915,0.10851,0.1143,0.12623,0.10492,0.10335,0.1166,0.079,0.11189,0.0568,0.1117,0.11696,0.09516,0.12156,0.09372,0.12654,0.06643,0.14122,0.08256,0.08094,0.12483,0.10834,0.13374,0.079,0.09117,0.02783,0.0524,0.0878,0.08316,0.08634,0.08783,0.19593,0.14209,0.11199,0.09834,0.22005,0.15952,0.19128,0.13706,0.13326,0.17266,0.17562,0.13732,0.11356,0.21362,0.15835,0.19974,0.17021,0.16089,0.12314,0.19946,0.11,0.11334,0.19952,0.14531,0.19148,0.17189,0.12207,0.12941,0.22618,0.1286,0.11178,0.16587,0.19671,0.13346,0.21603,0.16565,0.12215,0.20733,0.13709,0.11702,0.10941,0.2012,0.1357,0.19014,0.13344,0.12821,0.17807,0.16913,0.13275,0.08566,0.22413,0.18314,0.20121,0.16255,0.15708,0.14612,0.205,0.1076,0.11185,0.20354,0.14223,0.19159,0.15063,0.12659,0.11503,0.2088,0.13897,0.11439,0.19194,0.15565,0.12162,0.23176,0.16163,0.13882,0.1986,0.08914,0.13557,0.09221,0.13992,0.20243,0.09519,0.13048,0.10295,0.19605,0.14731,0.15194,0.08748,0.15616,0.19398,0.15374,0.17659,0.1452,0.16115,0.17247,0.10675,0.10213,0.14907,0.21009,0.08158,0.12191,0.09923,0.08887,0.21891,0.1326,0.14279,0.11573,0.19073,0.11673,0.14095,0.14891,0.11479,0.19737,0.10257,0.13469,0.11967,0.14627,0.16333,0.08453,0.14984,0.09918,0.19005,0.12662,0.16939,0.1076,0.18484,0.1881,0.15308,0.15268,0.11409,0.1772,0.15518,0.08968,0.15273,0.14097,0.21113,0.07964,0.11805,0.09163,0.10046,0.2182,0.13538,0.14253,0.13998,0.20014,0.15815,0.16735,0.14652,0.11835,0.20067,0.11382,0.14734,0.1188,0.18966,0.14876,0.08307,0.13924,0.07385,0.22653,0.14304,0.15599,0.06356,0.15804,0.20579,0.16371,0.15436,0.12829,0.18341,0.14388,0.1135,0.12851,0.1434,0.20464,0.09407,0.14826,0.07345,0.13605,0.21031,0.12476,0.1348,0.16081,0.20284,0.1079,0.17145,0.12996,0.1351,0.21743,0.11635,0.15231,0.10643,0.17865,0.1537,0.09072,0.12938,0.08478,0.19816,0.12686,0.15265,0.13238,0.18976,0.17912,0.17414,0.17581,0.13643,0.21133,0.10697,0.14414,0.12213,0.15321,0.21132,0.10702,0.1595,0.07563,0.16533,0.19184,0.12246,0.13242,0.17663,0.13504,0.08918,0.07629,0.10228,0.06517,0.203,0.13941,0.11426,0.22159,0.17592,0.18728,0.15603,0.14646,0.14231,0.21292,0.14041,0.1213,0.15897,0.22045,0.14388,0.21953,0.15961,0.13472,0.17316,0.13626,0.0965,0.15848,0.19999,0.1535,0.20399,0.14456,0.13222,0.18432,0.17948,0.11576,0.10152,0.20319,0.15092,0.20948,0.18802,0.15373,0.11438,0.21438,0.13814,0.10278,0.19452,0.13337,0.17252,0.15483,0.13049,0.14017,0.20787,0.12618,0.11392,0.19659,0.19128,0.15911,0.22135,0.16559,0.13543,0.21166,0.13003,0.10123,0.14961,0.19554,0.12894,0.20882,0.13161,0.11979,0.208,0.16169,0.12355,0.07525,0.23148,0.12189,0.22928,0.18298,0.14715,0.13357,0.09851,0.09439,0.08171,0.08148,0.10067,0.07318,0.06013,0.0909,0.09361,0.07372,0.09357,0.05663,0.04107,0.03525,0.03392,0.07491,0.12206,0.10128,0.09228,0.08778,0.06949,0.0929,0.08261,0.11361,0.08935,0.05557,0.07552,0.09344,0.10431,0.10249,0.04631,0.10737,0.01848,0.11435,0.11339,0.10137,0.09638,0.10252,0.11233,0.08114,0.09851,0.06629,0.06885,0.09005,0.08782,0.09797,0.12196,0.11636,0.10434,0.07441,0.07676,0.06692,0.11478,0.10899,0.10772,0.09028,0.09079,0.08751,0.09028,0.10082,0.10723,0.13963,0.10829,0.11677,0.09864,0.10367,0.07456,0.06943,0.22751,0.09206,0.22358,0.13486,0.10756,0.19418,0.1588,0.0888,0.13471,0.12371,0.21854,0.06319,0.13068,0.08358,0.09475,0.23363,0.12354,0.14188,0.16747,0.22694,0.13109,0.1817,0.12826,0.10922,0.20916,0.10509,0.14011,0.12476,0.18938,0.13763,0.07717,0.12671,0.06712,0.22551,0.13139,0.14876,0.1063,0.1687,0.21096,0.16677,0.17425,0.1235,0.20084,0.12751,0.1109,0.1035,0.14343,0.20651,0.06674,0.11704,0.06807,0.13744,0.18344,0.13662,0.14536,0.16251,0.21014,0.13837,0.19106,0.12338,0.11141,0.20549,0.10077,0.14183,0.13122,0.19578,0.13375,0.08343,0.13573,0.06987,0.22191,0.12305,0.1447,0.13357,0.17539,0.01697,0.07116,0.07143,0.07577,0.2094,0.1513,0.11047,0.08762,0.23486,0.12837,0.20536,0.12755,0.1011,0.1673,0.17235,0.11212,0.10847,0.21855,0.14777,0.21183,0.16601,0.13451,0.1114,0.21253,0.11704,0.10399,0.19881,0.12912,0.1794,0.14678,0.10535,0.0864,0.1825,0.10269,0.10689,0.17411,0.18195,0.10942,0.2308,0.16541,0.1479,0.11582,0.09802,0.08402,0.07313,0.10818,0.10311,0.05993,0.08621,0.0948,0.08743,0.07528,0.09438,0.03001,0.04084,0.01957,0.08406,0.07941,0.13309,0.08304,0.0924,0.06696,0.08305,0.10217,0.0977,0.11353,0.07957,0.03117,0.10347,0.10027,0.10831,0.07845,0.06963,0.07179,0.07425,0.13308,0.09855,0.07837,0.10769,0.08487,0.11095,0.08256,0.08668,0.0633,0.07897,0.10149,0.0852,0.11803,0.12427,0.10152,0.07953,0.0777,0.06403,0.089,0.10043,0.11454,0.11792,0.08553,0.11094,0.0617,0.10792,0.11109,0.11497,0.11294,0.09292,0.10543,0.11439,0.10302,0.06051,0.21501,0.1157,0.15809,0.1826,0.13219,0.10915,0.20871,0.13533,0.15665,0.13453,0.16423,0.17359,0.09198,0.16104,0.10764,0.20022,0.14881,0.15555,0.09577,0.18728,0.20256,0.16869,0.16364,0.11883,0.18498,0.14002,0.08454,0.1338,0.12973,0.20655,0.08049,0.13336,0.06361,0.07637,0.22371,0.11842,0.13335,0.15798,0.21712,0.15161,0.16373,0.11624,0.11728,0.22602,0.12545,0.16198,0.12442,0.18882,0.16024,0.08121,0.14831,0.09178,0.22288,0.14187,0.16035,0.10166,0.16218,0.20067,0.15982,0.17161,0.1209,0.20385,0.11795,0.10473,0.12996,0.14162,0.19688,0.08685,0.14087,0.07949,0.13031,0.2008,0.11796,0.13831,0.1657,0.19793,0.05469,0.0786,0.09157,0.08235,0.21994,0.1302,0.10191,0.21063,0.15568,0.15167,0.19668,0.13742,0.09837,0.20353,0.12364,0.11259,0.16467,0.20974,0.12403,0.20972,0.15265,0.13076,0.20498,0.13067,0.09203,0.06631,0.21498,0.12241,0.20505,0.12026,0.10685,0.16998,0.17678,0.11022,0.10479,0.22937,0.13872,0.05417,0.0092,0.0015,7.9E-4,7.2E-4,7.6E-4,8.0E-4,9.1E-4,0.001,0.00102,0.00107,0.00106,0.00107],\"hootCer\":0.37530266343825663,\"isStreamed\":false}}";
            ObjectMapper mapper = new ObjectMapper();
            Map<String, Object> parsed = mapper.readValue(lyrics, new TypeReference<>() {});
            List<Map<String, Object>> alignedWords = (List<Map<String, Object>>) parsed.get("alignedWords");

            ApiResponse<Object> apiResult = new ApiResponse<>(200, alignedWords, "Ok");
            return ResponseEntity.ok(apiResult);
        }catch (Exception e){
            ApiResponse<Object> errorResult = new ApiResponse<>(500, null, "가사 가져오기 실패");
            return ResponseEntity.ok(errorResult);
        }

    }

    private void saveSong(SongSaveLyricsDTO dto){
        Song song = Song.builder()
                .taskId(dto.getTaskId())
                .title(dto.getTaskId())
                .lyrics(dto.getLyrics())
                .songUrl(dto.getSongUrl())
                .songPath(dto.getSongPath())
                .prompt(dto.getPrompt())
                .build();

        songRepository.save(song);
    }
    public String saveLyrics(SongSaveLyricsDTO request){
        // 설명 : suno에서 가져온 가사 (timestamp 있는 버전)를 프론트에 불러오기 쉽게 한 줄 씩 포맷하고 db에 저장하는 api

        try{
//            int id = request.getId();
//            String taskId = request.getTaskId();
//            String title = request.getTitle();
//            String lyrics = request.getLyrics();
//            String songUrl = request.getSongUrl();
//            String songPath = request.getSongPath();
//            String prompt = request.getPrompt();



            saveSong(request);

        }catch (Exception e){
            throw new RuntimeException("가사 저장 실패", e);
        }

        return "";
    }
}
